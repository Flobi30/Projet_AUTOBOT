{% extends "base.html" %}

{% block title %}Performance{% endblock %}

{% block content %}
<div style="width: 100% !important; padding: 0 !important; margin: 0 !important;">
    <header style="display: flex !important; align-items: center !important; gap: 15px !important; margin-bottom: 30px !important;">
        <div style="width: 60px !important; height: 60px !important; background: linear-gradient(135deg, #00ff88, #00cc6a) !important; border-radius: 12px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 0 20px rgba(0, 255, 136, 0.3) !important;">
            <i class="fas fa-chart-bar" style="font-size: 28px !important; color: #000 !important;"></i>
        </div>
        <h2 style="color: #00ff88 !important; margin: 0 !important; font-size: 32px !important; text-shadow: 0 0 10px rgba(0, 255, 136, 0.5) !important;">PERFORMANCE</h2>
    </header>
    
    <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr 1fr !important; gap: 20px !important; margin-bottom: 30px !important;">
        <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; text-align: center !important;">
            <div style="color: #888 !important; font-size: 16px !important; margin-bottom: 10px !important;">ROI Global</div>
            <div style="color: #00ff88 !important; font-size: 36px !important; font-weight: bold !important;">+84.2%</div>
            <div style="color: #00ff88 !important; font-size: 14px !important;">Total</div>
        </div>
        <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; text-align: center !important;">
            <div style="color: #888 !important; font-size: 16px !important; margin-bottom: 10px !important;">Profit Journalier</div>
            <div style="color: #00ff88 !important; font-size: 36px !important; font-weight: bold !important;">+12.4%</div>
            <div style="color: #00ff88 !important; font-size: 14px !important;">Aujourd'hui</div>
        </div>
        <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; text-align: center !important;">
            <div style="color: #888 !important; font-size: 16px !important; margin-bottom: 10px !important;">Trades Gagnants</div>
            <div style="color: #00ff88 !important; font-size: 36px !important; font-weight: bold !important;">87%</div>
            <div style="color: #00ff88 !important; font-size: 14px !important;">Ratio</div>
        </div>
        <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; text-align: center !important;">
            <div style="color: #888 !important; font-size: 16px !important; margin-bottom: 10px !important;">Sharpe Ratio</div>
            <div style="color: #00ff88 !important; font-size: 36px !important; font-weight: bold !important;">2.47</div>
            <div style="color: #00ff88 !important; font-size: 14px !important;">Score</div>
        </div>
    </div>
    
    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; margin-bottom: 30px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Performance par Module</h3>
        <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr !important; gap: 20px !important;">
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <h4 style="color: #00ff88 !important; margin: 0 0 15px 0 !important;">Trading</h4>
                <div style="color: #00ff88 !important; font-size: 24px !important; font-weight: bold !important; margin-bottom: 10px !important;">+67.8%</div>
                <div style="color: #888 !important; font-size: 14px !important;">247 trades</div>
            </div>
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <h4 style="color: #00ff88 !important; margin: 0 0 15px 0 !important;">Arbitrage</h4>
                <div style="color: #00ff88 !important; font-size: 24px !important; font-weight: bold !important; margin-bottom: 10px !important;">+23.1%</div>
                <div style="color: #888 !important; font-size: 14px !important;">89 opportunités</div>
            </div>
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <h4 style="color: #00ff88 !important; margin: 0 0 15px 0 !important;">E-commerce</h4>
                <div style="color: #00ff88 !important; font-size: 24px !important; font-weight: bold !important; margin-bottom: 10px !important;">+15.7%</div>
                <div style="color: #888 !important; font-size: 14px !important;">34 produits</div>
            </div>
        </div>
    </div>

    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; margin-bottom: 30px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Système de Backtest Centralisé</h3>
        <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr !important; gap: 20px !important; margin-bottom: 20px !important;">
            <button style="width: 100% !important; padding: 15px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('Trading')">
                <i class="fas fa-chart-line" style="margin-right: 8px !important;"></i>Backtest Trading
            </button>
            <button style="width: 100% !important; padding: 15px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('Arbitrage')">
                <i class="fas fa-exchange-alt" style="margin-right: 8px !important;"></i>Backtest Arbitrage
            </button>
            <button style="width: 100% !important; padding: 15px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('E-commerce')">
                <i class="fas fa-shopping-cart" style="margin-right: 8px !important;"></i>Backtest E-commerce
            </button>
        </div>
        <div style="padding: 15px !important; background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important;">
            <div style="color: #ccc !important; font-size: 14px !important; margin-bottom: 10px !important;">Configuration Globale</div>
            <div style="display: flex !important; justify-content: space-between !important; margin-bottom: 5px !important;">
                <span style="color: #888 !important;">Capital Initial</span>
                <span style="color: #00ff88 !important;">500€</span>
            </div>
            <div style="display: flex !important; justify-content: space-between !important; margin-bottom: 5px !important;">
                <span style="color: #888 !important;">Objectif Journalier</span>
                <span style="color: #00ff88 !important;">10%</span>
            </div>
            <div style="display: flex !important; justify-content: space-between !important;">
                <span style="color: #888 !important;">Mode</span>
                <span style="color: #00ff88 !important;">Production Continue</span>
            </div>
        </div>
    </div>

    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Historique des Performances</h3>
        <div style="overflow-x: auto !important;">
            <table style="width: 100% !important; border-collapse: collapse !important;">
                <thead>
                    <tr style="border-bottom: 1px solid #333 !important;">
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Date</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Module</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Performance</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Volume</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Profit</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="border-bottom: 1px solid #222 !important;">
                        <td style="color: #ccc !important; padding: 12px !important;">2024-06-04</td>
                        <td style="color: #ccc !important; padding: 12px !important;">Trading</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+12.4%</td>
                        <td style="color: #ccc !important; padding: 12px !important;">2,450€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+304€</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #222 !important;">
                        <td style="color: #ccc !important; padding: 12px !important;">2024-06-04</td>
                        <td style="color: #ccc !important; padding: 12px !important;">Arbitrage</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+8.7%</td>
                        <td style="color: #ccc !important; padding: 12px !important;">1,200€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+104€</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #222 !important;">
                        <td style="color: #ccc !important; padding: 12px !important;">2024-06-04</td>
                        <td style="color: #ccc !important; padding: 12px !important;">E-commerce</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+5.2%</td>
                        <td style="color: #ccc !important; padding: 12px !important;">800€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+42€</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    async function startBacktest(module) {
        try {
            const response = await fetch(`/api/backtest/${module.toLowerCase()}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            });
            
            const result = await response.json();
            
            if (result.status === 'success') {
                alert(result.message);
            } else {
                alert('Erreur: ' + result.message);
            }
        } catch (error) {
            alert('Erreur lors du démarrage du backtest');
        }
    }
</script>
{% endblock %}
