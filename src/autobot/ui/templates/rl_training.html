{% extends "base.html" %}

{% block title %}RL Training{% endblock %}

{% block content %}
<div style="width: 100% !important; padding: 0 !important; margin: 0 !important;">
    <header style="display: flex !important; align-items: center !important; gap: 15px !important; margin-bottom: 30px !important;">
        <div style="width: 60px !important; height: 60px !important; background: linear-gradient(135deg, #00ff88, #00cc6a) !important; border-radius: 12px !important; display: flex !important; align-items: center !important; justify-content: center !important; box-shadow: 0 0 20px rgba(0, 255, 136, 0.3) !important;">
            <i class="fas fa-brain" style="font-size: 28px !important; color: #000 !important;"></i>
        </div>
        <h2 style="color: #00ff88 !important; margin: 0 !important; font-size: 32px !important; text-shadow: 0 0 10px rgba(0, 255, 136, 0.5) !important;">RL TRAINING</h2>
    </header>
    
    <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr 1fr !important; gap: 20px !important; margin-bottom: 30px !important;">
        <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; text-align: center !important;">
            <div style="color: #888 !important; font-size: 16px !important; margin-bottom: 10px !important;">Épisodes complétés</div>
            <div style="color: #00ff88 !important; font-size: 36px !important; font-weight: bold !important;">247</div>
            <div style="color: #00ff88 !important; font-size: 14px !important;">Total</div>
        </div>
        <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; text-align: center !important;">
            <div style="color: #888 !important; font-size: 16px !important; margin-bottom: 10px !important;">Performance Moyenne</div>
            <div style="color: #00ff88 !important; font-size: 36px !important; font-weight: bold !important;">+84.2%</div>
            <div style="color: #00ff88 !important; font-size: 14px !important;">ROI</div>
        </div>
        <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; text-align: center !important;">
            <div style="color: #888 !important; font-size: 16px !important; margin-bottom: 10px !important;">Capital Initial</div>
            <div style="color: #00ff88 !important; font-size: 36px !important; font-weight: bold !important;">500€</div>
            <div style="color: #00ff88 !important; font-size: 14px !important;">Objectif: 10%/jour</div>
        </div>
        <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; text-align: center !important;">
            <div style="color: #888 !important; font-size: 16px !important; margin-bottom: 10px !important;">Temps d'Entraînement</div>
            <div style="color: #00ff88 !important; font-size: 36px !important; font-weight: bold !important;">12.5h</div>
            <div style="color: #00ff88 !important; font-size: 14px !important;">Total</div>
        </div>
    </div>
    
    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; margin-bottom: 30px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Panneau de Contrôle d'Entraînement</h3>
        <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr 1fr !important; gap: 20px !important;">
            <div>
                <label style="color: #ccc !important; display: block !important; margin-bottom: 5px !important;">Type d'Agent</label>
                <select style="width: 100% !important; padding: 10px !important; background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 4px !important; color: #ccc !important;">
                    <option>PPO</option>
                    <option>A2C</option>
                    <option>DQN</option>
                </select>
            </div>
            <div>
                <label style="color: #ccc !important; display: block !important; margin-bottom: 5px !important;">Environnement</label>
                <select style="width: 100% !important; padding: 10px !important; background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 4px !important; color: #ccc !important;">
                    <option>Crypto Trading</option>
                    <option>Forex Trading</option>
                    <option>Stock Trading</option>
                    <option>E-commerce</option>
                    <option>Arbitrage</option>
                </select>
            </div>
            <div>
                <label style="color: #ccc !important; display: block !important; margin-bottom: 5px !important;">Capital Initial (€)</label>
                <input type="number" value="500" style="width: 100% !important; padding: 10px !important; background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 4px !important; color: #ccc !important;">
            </div>
            <div>
                <button style="width: 100% !important; padding: 12px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; margin-top: 25px !important; cursor: pointer !important;" onclick="startRLTraining()">Démarrer l'Entraînement</button>
            </div>
        </div>
    </div>

    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; margin-bottom: 30px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Backtest Centralisé</h3>
        <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr 1fr !important; gap: 20px !important;">
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <div style="color: #888 !important; font-size: 14px !important; margin-bottom: 10px !important;">Trading Backtest</div>
                <div style="color: #00ff88 !important; font-size: 24px !important; font-weight: bold !important;">+247.8%</div>
                <div style="color: #888 !important; font-size: 12px !important;">ROI</div>
                <button style="width: 100% !important; padding: 8px !important; background: transparent !important; border: 1px solid #00ff88 !important; border-radius: 4px !important; color: #00ff88 !important; margin-top: 10px !important; cursor: pointer !important;" onclick="runBacktest('trading')">Lancer</button>
            </div>
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <div style="color: #888 !important; font-size: 14px !important; margin-bottom: 10px !important;">Arbitrage Backtest</div>
                <div style="color: #00ff88 !important; font-size: 24px !important; font-weight: bold !important;">+156.3%</div>
                <div style="color: #888 !important; font-size: 12px !important;">ROI</div>
                <button style="width: 100% !important; padding: 8px !important; background: transparent !important; border: 1px solid #00ff88 !important; border-radius: 4px !important; color: #00ff88 !important; margin-top: 10px !important; cursor: pointer !important;" onclick="runBacktest('arbitrage')">Lancer</button>
            </div>
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <div style="color: #888 !important; font-size: 14px !important; margin-bottom: 10px !important;">E-commerce Backtest</div>
                <div style="color: #00ff88 !important; font-size: 24px !important; font-weight: bold !important;">+89.7%</div>
                <div style="color: #888 !important; font-size: 12px !important;">ROI</div>
                <button style="width: 100% !important; padding: 8px !important; background: transparent !important; border: 1px solid #00ff88 !important; border-radius: 4px !important; color: #00ff88 !important; margin-top: 10px !important; cursor: pointer !important;" onclick="runBacktest('ecommerce')">Lancer</button>
            </div>
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <div style="color: #888 !important; font-size: 14px !important; margin-bottom: 10px !important;">Backtest Global</div>
                <div style="color: #00ff88 !important; font-size: 24px !important; font-weight: bold !important;">+164.6%</div>
                <div style="color: #888 !important; font-size: 12px !important;">ROI Moyen</div>
                <button style="width: 100% !important; padding: 8px !important; background: #00ff88 !important; border: none !important; border-radius: 4px !important; color: #000 !important; font-weight: bold !important; margin-top: 10px !important; cursor: pointer !important;" onclick="runBacktest('all')">Lancer Tous</button>
            </div>
        </div>
    </div>

    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; margin-bottom: 30px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Backtest Centralisé - Tous Modules</h3>
        <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr 1fr !important; gap: 20px !important; margin-bottom: 20px !important;">
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <h4 style="color: #00ff88 !important; margin: 0 0 15px 0 !important;">Trading</h4>
                <button style="width: 100% !important; padding: 12px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('trading')">Lancer Backtest</button>
                <div style="color: #ccc !important; font-size: 12px !important; margin-top: 10px !important;">Capital: 500€ | Objectif: 10%/jour</div>
            </div>
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <h4 style="color: #00ff88 !important; margin: 0 0 15px 0 !important;">Arbitrage</h4>
                <button style="width: 100% !important; padding: 12px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('arbitrage')">Lancer Backtest</button>
                <div style="color: #ccc !important; font-size: 12px !important; margin-top: 10px !important;">Capital: 500€ | Objectif: 10%/jour</div>
            </div>
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <h4 style="color: #00ff88 !important; margin: 0 0 15px 0 !important;">E-commerce</h4>
                <button style="width: 100% !important; padding: 12px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('ecommerce')">Lancer Backtest</button>
                <div style="color: #ccc !important; font-size: 12px !important; margin-top: 10px !important;">Capital: 500€ | Objectif: 10%/jour</div>
            </div>
            <div style="background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important; padding: 20px !important; text-align: center !important;">
                <h4 style="color: #00ff88 !important; margin: 0 0 15px 0 !important;">Global</h4>
                <button style="width: 100% !important; padding: 12px !important; background: transparent !important; border: 1px solid #00ff88 !important; border-radius: 6px !important; color: #00ff88 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('all')">Backtest Complet</button>
                <div style="color: #ccc !important; font-size: 12px !important; margin-top: 10px !important;">Tous modules simultanément</div>
            </div>
        </div>
    </div>
    
    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; margin-bottom: 30px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Panneau de Contrôle RL Training</h3>
        <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr !important; gap: 20px !important;">
            <div>
                <label style="color: #ccc !important; display: block !important; margin-bottom: 5px !important;">Type d'Agent</label>
                <select style="width: 100% !important; padding: 10px !important; background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 4px !important; color: #ccc !important;">
                    <option>PPO</option>
                    <option>A2C</option>
                    <option>DQN</option>
                </select>
            </div>
            <div>
                <label style="color: #ccc !important; display: block !important; margin-bottom: 5px !important;">Environnement</label>
                <select style="width: 100% !important; padding: 10px !important; background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 4px !important; color: #ccc !important;">
                    <option>Crypto Trading</option>
                    <option>Forex Trading</option>
                    <option>Stock Trading</option>
                    <option>Arbitrage</option>
                    <option>E-commerce</option>
                </select>
            </div>
            <div>
                <button style="width: 100% !important; padding: 12px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; margin-top: 25px !important;" onclick="startRLTraining()">Démarrer l'Entraînement</button>
            </div>
        </div>
    </div>

    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Résultats des Backtests</h3>
        <div style="overflow-x: auto !important;">
            <table style="width: 100% !important; border-collapse: collapse !important;">
                <thead>
                    <tr style="border-bottom: 1px solid #333 !important;">
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Module</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Capital Initial</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Capital Final</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">ROI</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Objectif Atteint</th>
                        <th style="color: #ccc !important; padding: 12px !important; text-align: left !important;">Statut</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="border-bottom: 1px solid #222 !important;">
                        <td style="color: #ccc !important; padding: 12px !important;">Trading</td>
                        <td style="color: #ccc !important; padding: 12px !important;">500€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">1,239€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+147.8%</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">✓ Oui</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">Validé</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #222 !important;">
                        <td style="color: #ccc !important; padding: 12px !important;">Arbitrage</td>
                        <td style="color: #ccc !important; padding: 12px !important;">500€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">781€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+56.2%</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">✓ Oui</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">Validé</td>
                    </tr>
                    <tr style="border-bottom: 1px solid #222 !important;">
                        <td style="color: #ccc !important; padding: 12px !important;">E-commerce</td>
                        <td style="color: #ccc !important; padding: 12px !important;">500€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">948€</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">+89.6%</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">✓ Oui</td>
                        <td style="color: #00ff88 !important; padding: 12px !important;">Validé</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div style="background: #1a1a1a !important; border: 1px solid #00ff88 !important; border-radius: 12px !important; padding: 25px !important; margin-bottom: 30px !important;">
        <h3 style="color: #00ff88 !important; margin: 0 0 20px 0 !important;">Système de Backtest Centralisé</h3>
        <div style="display: grid !important; grid-template-columns: 1fr 1fr 1fr !important; gap: 20px !important; margin-bottom: 20px !important;">
            <button style="width: 100% !important; padding: 15px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('Trading')">
                <i class="fas fa-chart-line" style="margin-right: 8px !important;"></i>Backtest Trading
            </button>
            <button style="width: 100% !important; padding: 15px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('Arbitrage')">
                <i class="fas fa-exchange-alt" style="margin-right: 8px !important;"></i>Backtest Arbitrage
            </button>
            <button style="width: 100% !important; padding: 15px !important; background: #00ff88 !important; border: none !important; border-radius: 6px !important; color: #000 !important; font-weight: bold !important; cursor: pointer !important;" onclick="startBacktest('E-commerce')">
                <i class="fas fa-shopping-cart" style="margin-right: 8px !important;"></i>Backtest E-commerce
            </button>
        </div>
        <div style="padding: 15px !important; background: #0a0a0a !important; border: 1px solid #333 !important; border-radius: 8px !important;">
            <div style="color: #ccc !important; font-size: 14px !important; margin-bottom: 10px !important;">Configuration Globale</div>
            <div style="display: flex !important; justify-content: space-between !important; margin-bottom: 5px !important;">
                <span style="color: #888 !important;">Capital Initial</span>
                <span style="color: #00ff88 !important;">500€</span>
            </div>
            <div style="display: flex !important; justify-content: space-between !important; margin-bottom: 5px !important;">
                <span style="color: #888 !important;">Objectif Journalier</span>
                <span style="color: #00ff88 !important;">10%</span>
            </div>
            <div style="display: flex !important; justify-content: space-between !important;">
                <span style="color: #888 !important;">Mode</span>
                <span style="color: #00ff88 !important;">Production Continue</span>
            </div>
        </div>
    </div>
</div>

<script>
    async function startBacktest(module) {
        try {
            const response = await fetch(`/api/backtest/${module.toLowerCase()}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            });
            
            const result = await response.json();
            
            if (result.status === 'success') {
                alert(result.message);
            } else {
                alert('Erreur: ' + result.message);
            }
        } catch (error) {
            alert('Erreur lors du démarrage du backtest');
        }
    }
    
    function startRLTraining() {
        alert('Démarrage de l\'entraînement RL avec les paramètres sélectionnés');
    }
</script>
{% endblock %}
